// Copyright 2019 the orbs-network-go authors
// This file is part of the orbs-network-go library in the Orbs project.
//
// This source code is licensed under the MIT license found in the LICENSE file in the root directory of this source tree.
// The above notice should be included in all copies or substantial portions of the software.

package keys

import (
	"encoding/hex"
	"github.com/orbs-network/orbs-network-go/crypto/hash"
	"github.com/orbs-network/orbs-network-go/crypto/keys"
	"github.com/orbs-network/orbs-spec/types/go/primitives"
)

type ecdsaSecp256K1KeyPairHex struct {
	publicKey  string
	privateKey string
}

var ecdsaSecp256K1KeyPairs = []ecdsaSecp256K1KeyPairHex{
	{"30fccea741dd34c7afb146a543616bcb361247148f0c8542541c01da6d6cadf186515f1d851978fc94a6a641e25dec74a6ec28c5ae04c651a0dc2e6104b3ac24", "901a1a0bfbe217593062a054e561e708707cb814a123474c25fd567a0fe088f8"},
	{"e083ab26159e08171c8873295dde9859a9225fa9b50bb91deb972035406878647a18992f82d94930546ea255917ef9d31fd206db94e708db43e925e4efcdd1d3", "87a210586f57890ae3642c62ceb58f0f0a54e787891054a5a54c80e1da418253"},
	{"6a494cf5b39cbaea22615ab6da3f8d11b668d904849a2aadaac22b3e60487562e4ceb9c1328d598bb2c79eaff131c429e0f7c76717de429f6a7f385c627a2e48", "426308c4d11a6348a62b4fdfb30e2cad70ab039174e2e8ea707895e4c644c4ec"},
	{"0155dbfb5553c9e650078561344c5e23f35bf4639994e29c207a263aed766e57c21c35ab64ccd081e06a01220c13bd9219098c75d3d7bf4c096f382bdb7b457d", "1e404ba4e421cedf58dcc3dddcee656569afc7904e209612f7de93e1ad710300"},
	{"a239a6f5fb4c0194623c0ea3ba89fb737922cde5f5c12bfcc19cf9ecee99b76dac32d24190b18b7cbf0d05155884342a182ed02ebebb8e975207e496957cf6e9", "0860f557af1b29639b680a5934e2080d204d08f753679e606f1bcb4b53d00efe"},
	{"072ba860aa0710f21f97b2f74f8b7a7e6bac56bc5f273f0bea333159f352f0fe29b1e7c34ce3148c894e87323656f8127d64ae8dbebf2e48a7976629631ca6d7", "a8ca24ef5d3dc54df3a692ee5b27a9bfa06c4ae8ecf77e20db55acd7637087e1"},
	{"ca3b4cf43a625dfb86d83acb78d40402995f17da1354810f51683176d159168bcfeb006b5e8b20a2c9f090a4aebfb8cd9cfa9783daad9f497ebc099be80aadf4", "a414d64a2246e394019f37544c17a8cae94b8f2104b9a5957c7af8691cb3302c"},
	{"ecfc44abed95eb70feb664f753a07a41ba732ad78aa3fddd7d0a735068da9f3ec4265223ec36ab9d7de452630f3bdcace3a61d269a59c8c381e15ace66cb2d45", "97809939376f2cb7d0d0cdf6531b3389080f1342ed7ccc46d55aa3b0445fc906"},
	{"0c6a30b0f4de9bb6f35a7814c483f931b7185db2702a4af8aae79a3589a680f16046d1ba6bd3f40607e5a2ea6d2c44bd18b3303935eda96611a495d6ecc8e479", "f4cd604644c170c487643c22121270415356b6f791c32887b5d22b42bbf83505"},
	{"a69b19f571824184f7847d9ed0e12f92b42688b56a28513d40683de09fb22f2071cbc80cc2850c435e7688b2a4534aa4b8f5deda0d65b2e3afe292ec260a0ac7", "c2ee571d81465cfcea039092a717b8460f8c96b82923b2ea7bb9765da8d013d6"},
	{"a250d9057b2922b639a32ec7a160c08e0ddc4fcbabe629fb27d5ab0550d0c5cbb608e249a870a3af3c76816c9954d0035b15cc130bfe75439ee73b1943d6f62d", "22775ef7cf528180a2db1f6074a150c83fe8f1efd10b281da0498e106cc49846"},
	{"7cefb4c06cddd084ec8422c193391fec8942aef3cea65183311904ab3a012d32de28993652cde2c8f4b263e76656d3c1558de8be57a5b1a4214de26de19b1c50", "c3cd7e05d1b3cf29f0baa61ac3f8ab824e0ed344146e22625a78dfec8cc402d1"},
	{"b2e15708cb5cf08da7156ba046268f994790e19d2617ec940817cf33ee10678c07b1160e1b1411d135528bb58549574adb14d4539b6e366c87584b38cf0e5de2", "e2fd5ebcc852ba4c26706154a923fcee856a97898be7cd29fb6c6c63d1721f83"},
	{"4bbf5622ba638a976d3fec959f948a160357451faa38c6d2e77d682aafc65dbab8ef7c2bb8610a282998b70e616e694fb3675baef89d705229f2f57460d31c52", "de3d15439a09bcd017966970e5ce3600fc592740de5b3e46f9b01c3108461b8a"},
	{"a45de1b102fe03757ff5af7017915a85d893d530a14dd4dab9328b450147f4e93da79c18c450f27fa4fbb0d646b285f7eaf546a3ffbc3e5cca4cb5135a4dc5ff", "e40c729138daf1ea19caab6e8bce799d5726adec6d5b10cca2c57b9ee0a71c66"},
	{"06043fbeb591fd8cc5ec7721796db4cf6ccc2c7c4b9a51c1bc232fb5d3abf9f4ebdf4d6f5945d1865d57a4e216ba3fb6d00d2e8858375d3c20994378fee5ccb7", "5135515a8f6dc3a2495b45c8a49c37a2442a60f66e42b86d06ac7e0cff4d31a1"},
	{"d90d593745af2780934894eb8680900647c8215528043756394fdf36c038e241bfea0f6ed884f29b436a92e9ed87ba1e29a6d02737674917449f32ac73b506c2", "bc59483089ffc3bbdbb083984fe7a03fb4cb82f251f4c7474369a2c703730ee2"},
	{"e8a78d02234292f8d6faa640077d5d5db5bac57930883ad05a4aa5f29164ae21a2f2e7bc28a686fae9762a1cc7281762b024dbbd30cb2e9088bb78022359d2c7", "15e4a8e7c51919c1770da3ce32027c89bdd07b10c5f9d713918c9d599ded7b2f"},
	{"2081b17c436cf835233bc0d83f9030b3c7d9ef5ec08fb4f52681c4dfa7f7a7c3cefb79420b5d6a986368daf13596daeecf2a8991f4e32ed1539e51433f387e1a", "34ffffe2a6cbdfb4c5835bf2c944c02c5966b61440a14e91bdd686a548d8de15"},
	{"f9e9cda06fa320663f85a7e39d9fffcf53ab2bccda9655647adfe09d5902582a60a8d4060a4983eb2973b68b612e3f7b0e6fd3929568c0d391a2a49c996ac474", "1e4c067360dd8b81db5de2609783c505f61f239cd970195d00165dd9e4df774b"},
	{"f15424b83a1ab3dc048806868bbaa0efcdb95ef2201e81ee176aacd8dfa3069db8f2fe25d92dbcbb7b3b0cf7820345385120272d6d7aa6ee0929d5fedfb55525", "5eacf0d541038e934ea3923239d3e4722cb0692b6b34e2ef7d70273cd3a9bac7"},
	{"e206b421f3500eb1a5f4b1916c19e1c52bd6dc4791cee69fae573db29a4ca2cbd337a551e385885cc3d9a033dc933749d7c638abe08b78dbafa5958557ac9923", "090d1ec73ad5bfd7c1f2ef5b9152c1e099ec706b3c2283436b4df7e313ec1bc0"},
	{"9581e87d449dedbb9cc791d5557166392d71033bad4c505e6f115ccaf5e7a4aa4ea936b8c5f2cdd04e93d095a86a5c474196ac03cb3a170f7742e1d2b86593b8", "c251fbccce82f524d6814dbdd2aa159b3b19e6a9817ecef2b5203d3276c4d1da"},
	{"638dfceea680cb65688e8cba8996cb1bd04b49b2eb2b1982583a92bb7ed32ad9d5585d1b629a14230b0f6733128cb86a38e6f925a0a1ad2694a5ca716f3fd24b", "6f8de8b37493cdbb0200821587e815aaf87d1d8a40f6f37183d87a88ce2eef89"},
	{"6781d199b25f7a3e3e2ed078985dfbb0acf9057bf51ad7b3fc6e7c9f2f0b17dab59b4c5bc54453f3f2aeb272f46ef39e46d1267f2e2f5a46bc4f5d79aed49464", "c30bf9e301a19c319818b34a75901fd8f067b676a834eeb4169ec887dd03d2a8"},
	{"97a794e8e02ad5151427205e69b0e7de1ac93fffc3f8ff8062203f1dc133fad11b558f69cc9cba926a987e625332a8cb67b2da06d754e2c68b473f599b3d6e16", "ede476b367b1554130cf2e277058b0f886e903d1621e252fd5ab4e3f969210a5"},
	{"0486d846d59bbf7202cc75a1805b41b690cdc5a02f70527b795242e3a03a7af273a71fdc7ac19c9d897ebefe4df9c88618f6838afedba907502d425b8c2967d7", "019866eab74307c96dda3ac5b6e8080db88773cfd9d42f156a2f0bad2a897e3a"},
	{"074e0877511a32f961083ae3e71be7b7f33b4def7d15e205fc78f5a48ab1f129305bf3f35a81d65d0ca3b5378bb78853af834fc2cecb6929d19a302b9b42e753", "dcc6189f8bb691c64029c0a3915d8f7d89728fea01394fccae33cfea090f8f11"},
	{"ce92f222136695d6c1ea8829c54fc9de565769fb7dd0d068cd2001618acc3e0c8cb0f50b682892ccfe54315457664fdafaf4521192edcf540d7bc6965a7456c0", "59508259e83ebc83d8dd7f0bb58fc8bb17c1d0ca398a5ce09558e6ed3f547aca"},
	{"f43acaae05ceb12d5899829b337478c3954d3b189b91b10dd37b643c4917220c419eaa43a35f8df765ca33559a0350bbe50d89847d4ac2ad8465cec365f9013b", "e0b9d2826741684d9adc721898192d48a7fa22760bb91244684aaf2d63b20525"},
}

func EcdsaSecp256K1KeyPairForTests(setIndex int) *TestEcdsaSecp256K1KeyPair {
	if setIndex > len(ecdsaSecp256K1KeyPairs) {
		return nil
	}

	pub, err := hex.DecodeString(ecdsaSecp256K1KeyPairs[setIndex].publicKey)
	if err != nil {
		return nil
	}

	pri, err := hex.DecodeString(ecdsaSecp256K1KeyPairs[setIndex].privateKey)
	if err != nil {
		return nil
	}

	return &TestEcdsaSecp256K1KeyPair{keys.NewEcdsaSecp256K1KeyPair(pub, pri)}
}

type TestEcdsaSecp256K1KeyPair struct {
	*keys.EcdsaSecp256K1KeyPair
}

func (k *TestEcdsaSecp256K1KeyPair) NodeAddress() primitives.NodeAddress {
	return primitives.NodeAddress(hash.CalcKeccak256(k.PublicKey())[12:])
}

func NodeAddressesForTests() []primitives.NodeAddress {
	res := make([]primitives.NodeAddress, len(ecdsaSecp256K1KeyPairs))

	for i := 0; i < len(ecdsaSecp256K1KeyPairs); i++ {
		res[i] = EcdsaSecp256K1KeyPairForTests(i).NodeAddress()
	}
	return res
}

func NodeAddressesForTestsToIndexes(nodeAddresses []primitives.NodeAddress) []int {
	var res []int
	for _, nodeAddress := range nodeAddresses {
		for index := 0; index < len(ecdsaSecp256K1KeyPairs); index++ {
			if EcdsaSecp256K1KeyPairForTests(index).NodeAddress().Equal(nodeAddress) {
				res = append(res, index)
				break
			}
		}
	}
	return res
}
